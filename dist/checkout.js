!function(){"use strict";const e="https://backorinoco.nitatemic.ovh/api/teddies";function t(e,t,l,a){n(e+"Li"+a,"list-group-item d-flex justify-content-between lh-sm","cartListUl"),function(e,t,n,l){let a=document.createElement("div");document.getElementById(e+"Li"+l).appendChild(a);let o=document.createElement("h6");o.innerHTML=e,o.className="my-0",a.appendChild(o);let c=document.createElement("span");c.innerHTML=t,c.className="text-muted",a.appendChild(c);let r=document.createElement("span");r.className="text-muted",r.innerHTML=n,document.getElementById(e+"Li"+l).appendChild(r)}(e,t,l,a)}function n(e,t,n){let l=document.createElement("li");l.id=e,l.className=t,document.getElementById(n).appendChild(l)}let l=JSON.parse(localStorage.getItem("cart"));!function(e,t){document.getElementById("numberOfItems").innerHTML=function(e){return null===e?0:e.length}(e)}(l),function(e,t,n){let l=document.createElement("ul");l.id="cartListUl",l.className="list-group mb-3",document.getElementById("cartList").appendChild(l)}(),async function(){let n=0;for(let a=0;a<l.length;a++){let o=l[a].id;try{let c=await fetch(e+"/"+o);if(!c.ok)throw Error("Probleme de connexion api");let r=await c.json();n+=r.price,t(r.name,l[a].color,r.price/100+"€",l.indexOf(l[a]))}catch(e){console.error("Oops, an error occurred. Please contact alexandre@nitatemic.ovh")}}return n}().then((e=>{n("totalLi","list-group-item d-flex justify-content-between","cartListUl");let t=document.createElement("span");t.innerHTML="Total (EUR)",document.getElementById("totalLi").appendChild(t);let l=document.createElement("strong");l.innerHTML=e/100+"€",document.getElementById("totalLi").appendChild(l)})),document.getElementById("btnCommander").onclick=function(t){t.preventDefault();let n=new FormData(document.querySelector("form"));if(1==(a=n.get("email"),!!/^([a-z0-9]+(?:[._-][a-z0-9]+)*)@([a-z0-9]+(?:[.-][a-z0-9]+)*\.[a-z]{2,})$/i.test(a))){let t=Object.create({});t.lastName=n.get("lastName"),t.firstName=n.get("firstName"),t.email=n.get("email"),t.address=n.get("address"),t.city=n.get("city");let a={contact:t,products:l.map((e=>e.id))};console.log(a),fetch(e+"/order",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{console.log("order",e),localStorage.removeItem("cart"),window.location.href="thankyou.html?order="+response.orderId}))}else alert("Veuillez entrer une adresse mail valide");var a}}();